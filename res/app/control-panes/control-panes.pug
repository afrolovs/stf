doctype html
html(lang="ru", data-mdb-theme="dark", data-bs-theme="dark")
  head
    meta(charset="UTF-8")
    meta(name="viewport" content="width=device-width, initial-scale=1.0")
    title {{device.marketName ? device.marketName : device.model}} – Device Ranch
    // Montserrat font
    link(href="https://fonts.googleapis.com/css2?family=Inter:wght@600&family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet")
    // Material Icons
    link(href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,GRAD@48,300,-25" rel="stylesheet")
    // MDBootstrap
    link(href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/6.4.0/mdb.min.css" rel="stylesheet")
    style.
      html {
        font-size: inherit !important
        }
      body {
        overflow: hidden !important;
        position: relative !important;
        min-height: 100vh !important;
        padding-bottom: 60px !important;
        margin: 0 !important;
        font-family: "Montserrat", serif !important;
        background: #000000 !important;
        color: #fff !important;
        font-size: 12px !important;
      }
      li:first-child {
        margin-top: 1em;
      }
      li+li {
        margin-top: 1em;
      }
      .btn {
        border-width: 1px;
        margin: 0.5em 0.75em 0.5em 0;
      }

        .link {
            color: lightgray;
            text-decoration: underline dotted 1px;
        }

        .form-switch .form-check-input {
            background-color: gray;
        }

        .logo-container {
            display: flex;
            position: absolute;
            align-items: center;
            top: 1rem;
            left: 1rem;
            z-index: 1000;
        }

        .logo {
            margin: 2.25rem;
            width: 9.25rem;
            z-index: 9999;
        }

        .logo-heading {
            margin-left: 1rem;
            margin-top: 0.75rem;
            font-size: 20px;
            color: #FFFFFF;
            font-family: "Montserrat", serif;
            font-weight: 600;
            font-style: normal;
        }

        .main-content {
            display: flex;
            height: 100vh;
            /*height: calc(100vh - 60px); */
            transition: all 0.3s ease;
        }

        .device-wrapper {
            flex-grow: 1;
            display: flex;
            justify-content: center;
            transition: all 0.3s ease;
            overflow: hidden;
            position: relative;
        }

        .device-container {
            display: flex;
            justify-content: center;
            align-items: center;
            /* padding: 20px; */
            width: 50%;
            height: 100%;
        }

        .screen-content {
            width: 100%;
            height: 100%;
            background: #0000;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            font-size: 24px;
            /* color: #adb5bd; */
        }

        .bottom-menu {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 60px;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            /* border-top: 1px solid #495057; */
        }

        .bottom-menu .menu-item {
            padding: 0 25px;
            text-align: center;
            cursor: pointer;
            /* color: #adb5bd; */
            transition: color 0.3s;
            font-size: 24px;
            display: flex;
            justify-content: center;
        }

        .bottom-menu .menu-item:hover {
            color: #2B06AB;
        }

        .side-menu {
            width: 60px;
            /* border-left: 1px solid #495057; */
            display: flex;
            flex-direction: column;
            transition: all 0.3s ease;
            position: relative;
            z-index: 2;
            flex-shrink: 0;
        }

        .side-menu.expanded {
            width: 220px;
        }

        .side-menu-toggle {
            padding: 15px;
            display: flex;
            align-items: center;
            white-space: nowrap;
            color: #adb5bd;
            cursor: pointer;
            transition: all 0.3s;
            justify-content: center;
        }

        .side-menu.expanded .side-menu-toggle {
            justify-content: flex-start;
            padding-left: 15px;
        }

        .side-menu-toggle:hover {
            background: #343a40;
            color: #fff;
        }

        .side-menu-toggle .material-icons {
            font-size: 24px;
            width: 24px;
            height: 24px;
        }

        .side-menu-divider {
            height: 1px;
            background-color: #495057;
            margin: 0;
        }

        .side-menu-section {
            padding: 15px;
            display: flex;
            align-items: center;
            white-space: nowrap;
            /* color: #adb5bd; */
            cursor: pointer;
            transition: all 0.3s;
            justify-content: center;
        }

        .side-menu.expanded .side-menu-section {
            justify-content: flex-start;
            padding-left: 15px;
        }

        .side-menu-section:hover {
            background: #230c7679;
            color: #fff;
        }

        .side-menu-section .material-icons {
            font-size: 24px;
            width: 24px;
            height: 24px;
        }

        .side-menu-section-title {
            overflow: hidden;
            text-overflow: ellipsis;
            opacity: 0;
            width: 0;
            transition: opacity 0.2s 0.1s, margin-left 0.2s 0.1s;
            margin-left: 0;
        }

        .side-menu.expanded .side-menu-section-title {
            opacity: 1;
            width: auto;
            margin-left: 15px;
        }

        .side-menu-section.active {
            /* background: #2a06ab5d; */
            color: #582ef0;
        }

        .side-panel-content {
            position: fixed;
            margin-top: 2.5rem;
            right: -400px;
            top: 0;
            width: 400px;
            height: 100vh;
            z-index: 1;
            padding: 20px;
            overflow-y: auto;
            transition: right 0.3s ease;
        }

        .side-panel-content.active {
            right: 60px;
        }

        .side-menu.expanded~.side-panel-content.active {
            right: 220px;
        }

        #app-logs.side-panel-content.active {
            width: 700px;
        }

        .screen-size-info {
            font-size: 12px;
            margin-top: 10px;
            color: #6c757d;
        }

        .orientation-controls {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #495057;
        }

        .btn.active {
            background-color: #2B06AB;
            color: white;
        }

        .size-controls {
            display: flex;
            gap: 8px;
        }

        .size-controls .btn {
            flex: 1;
            padding: 5px;
        }

        .form-label {
            color: lightgray;
        }

        .side-menu-toggle-title {
            overflow: hidden;
            text-overflow: ellipsis;
            opacity: 0;
            width: 0;
            transition: opacity 0.2s 0.1s, margin-left 0.2s 0.1s;
            margin-left: 0;
        }

        .side-menu.expanded .side-menu-toggle-title {
            opacity: 1;
            width: auto;
            margin-left: 15px;
        }

        /* Стили для нижнего меню */
        .bottom-menu {
            display: flex;
            justify-content: center;
            align-items: center;
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 60px;
            z-index: 1000;
            /* border-top: 1px solid #495057; */
        }

        /* Центральная группа иконок */
        .menu-center-group {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Левая часть с ссылкой */
        .menu-center-left {
            cursor: pointer;
            position: absolute;
            left: 20px;
            display: flex;
            align-items: center;
        }

        /* Правая часть с ссылкой */
        .menu-center-right {
            position: absolute;
            right: 20px;
            display: flex;
            align-items: center;
        }

        /* Разделитель между иконками */
        .menu-divider {
            height: 20px;
            width: 1px;
            background-color: rgba(255, 255, 255, 0.2);
            margin: 0 15px;
        }

        /* Стили для иконок */
        .menu-item {
            padding: 0 5px;
            color: #adb5bd;
            transition: color 0.3s;
            font-size: 24px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .menu-item:hover {
            color: #0d6efd;
        }

        /* Стили для ссылки Mattermost */
        .mattermost-link {
            display: flex;
            align-items: center;
            color: inherit;
            text-decoration: none;
        }

        .mattermost-icon {
            width: 12px;
            height: 12px;
            fill: #adb5bd;
            margin-top: 2px;
        }

        .mattermost-text {
            font-size: 12px;
            margin-left: 5px;
            color: #adb5bd;
        }

        .bg-glass {
            background: #00000020;
            backdrop-filter: blur(5px);
        }

        .bg-dark {
            background-color: #111 !important;d
        }

        .gradient {
            position: absolute;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, #x 10%, transparent 40%);
            opacity: 0;
            z-index: -1;
        }

        #gradient2 {
            top: -100%;
            left: -120%;
            animation: fadeInOut 18s infinite ease-in-out;
            animation-delay: 0s;
        }

        #gradient3 {
            top: -50%;
            left: 20%;
            animation: fadeInOut 18s infinite ease-in-out;
            animation-delay: 6s;
        }

        .tippy-box[data-theme~='okko'] {
            background-color:rgb(13, 6, 39);
            color: whitesmoke;
            font-family: "Montserrat", sans-serif;
            word-break: keep-all;
            text-align: start;
            font-size: 12px;
        }

      @keyframes fadeInOut {
        0% { opacity: 0; }
        50% { opacity: .8; }
        67% { opacity: 0; }
      }

      .interact-control {
        display: flex;
        flex-direction: column;
        height: 100%;
        width: 100%;
      }

      device-screen {
        display: block;
        height: 100%;
        width: 100%;
        background: transparent;
        overflow: visible;
      }

      .device-screen-wrapper {
        height: calc(100% - 8em);
        width: calc(100% - 8em);
        margin: 5em 4em;
        background: transparent;
      }

      .screen {
        background-color: #000000;
        box-shadow: 0px 0px 25px 4px #4806ab53;
        overflow: visible;
        position: relative;
        transform-origin: center center;
        transition: transform 0.3s ease, width 0.3s ease, height 0.3s ease;
      }

      .form-control {
        color: rgba(255,255,255, 0.8);
        background-color: #582ef020;
        border: 1px solid rgba(255, 255, 255, 0.6);
        border-radius: 0.25rem;
      }

      .form-control:focus {
        color: white;
        background-color: #582ef020;
      }

      .btn {
        margin: 0 !important;
        margin-right: 0px !important;
      }


      .btn:active {
        color: white !important;
      }

      .btn:hover, .btn:active, .btn:focus, .btn:focus-visible {
        color: #582ef0 !important;
        border-color: rgba(255, 255, 255, 0.12) !important;
      }

      .btn-outline-secondary, .btn-outline-secondary:disabled, .btn-outline-secondary:hover {
        color: white;
        border-color: 1px solid rgba(255, 255, 255, 0.19)
      }

      .input-group > .form-control:focus {
        border-color: #582ef0;
      }

      .form-control[readonly] {
        background-color: black !important;
      }

      #adb-port {
        box-shadow: none;
      }
      textarea {
        resize: none;
      }

      .widget-container {
        background-color: #582ef020;
      }

      .alert {
        background-color: rgb(44, 15.2, 20);
        color: rgb(227, 111.8, 131);
      }

      .alert-info {
        background-color: #582ef060;
        color: #DDD;
      }

      strong {
        font-weight: 500;
      }

      .btn-close {
        box-sizing: content-box;
        width: 1em;
        height: 1em;
        padding: .25em;
        color: #000;
        background: transparent url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Cpath fill='%23DDD' d='M.293.293a1 1 0 011.414 0L8 6.586 14.293.293a1 1 0 111.414 1.414L9.414 8l6.293 6.293a1 1 0 01-1.414 1.414L8 9.414l-6.293 6.293a1 1 0 01-1.414-1.414L6.586 8 .293 1.707a1 1 0 010-1.414z'/%3E%3C/svg%3E") 50%/1em auto no-repeat;
        border: 0;
        border-radius: .25rem;
        opacity: .5;
      }

      .selectable-text {
        user-select: text !important;
        -webkit-user-select: text !important;
        -moz-user-select: text !important;
        -ms-user-select: text !important;
        cursor: text !important;
      }

      tr, tbody {
        border: none;
      }

      .logcat-filters-table td {
        border-bottom-width: 0;
      }

      /* Фикс рендера кнопок для Chrome */
      @media screen and (-webkit-min-device-pixel-ratio:0) {
        .btn, .form-control {
          transform: translateZ(0); /* Активирует GPU рендеринг */
          zoom: 1; /* Фикс для некоторых версий Chrome */
        }
      }

      /* Фикс рендера кнопок для Safari */
      _::-webkit-full-page-media, _:future, :root .safari-only {
        font-size: 9px;
        line-height: 1.2;
      }

      /* Normalize для кнопок и инпутов */
      button, input, textarea, select {
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;
        font-size: 9px;
        font-family: inherit;
        line-height: normal;
        margin: 0;
        padding: 0;
        border-radius: 0;
        background-image: none;
      }

      /* Принудительный рендеринг */
      * {
        text-rendering: optimizeLegibility;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        text-size-adjust: 100%;
      }

      /* Для всех интерактивных элементов */
      .btn, .input-group-text {
        font-size: 9px !important;
        line-height: 24px !important;
        padding: 0 8px !important;
        min-width: 60px;
      }

      /* Специфичные стили для input/textarea */
      .form-control,
      input[type="text"],
      input[type="password"],
      textarea {
        font-size: 12px !important;
        height: 24px;
        padding: 4px 8px !important;
        line-height: 16px !important;
      }

      .watch {
        pointer-events: none;
        user-select: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
      }

      .device-table {
        border: none;
        padding: 4px;
        color: rgba(255,255,255,.65);
      }

      .device-table th {
        font-size: 12px !important;
        border: none !important;
        border-top: none !important;
        cursor: pointer;
      }

  body
    // Логотип и описание
    .logo-container
      .logo
        img(src="static/logo/exports/logo.svg" alt="Okko")
      a(href="#")
        .logo-heading(ng-if="!isWatchMode") Управление устройством
        .logo-heading(ng-if="isWatchMode") Наблюдение за устройством

    // Основной контент
    .main-content#mainContent
      // Контейнер устройства
      .device-wrapper#deviceWrapper
        .device-container
          .screen-content(ng-class="{'watch': isWatchMode}")
            div(ng-include='"control-panes/device-control/device-control.pug"').fill-height

      // Боковое меню
      .side-menu.bg-glass#sideMenu
        .side-menu-toggle#sideMenuToggle
          span.material-symbols-outlined menu
          span.side-menu-toggle-title Свернуть панель

        .side-menu-section(data-panel="app-panel", ng-if="!isWatchMode")
          span.material-symbols-outlined apps
          span.side-menu-section-title Работа с приложением

        .side-menu-section(data-panel="app-logs")
          span.material-symbols-outlined developer_mode
          span.side-menu-section-title Логи и отладка

        .side-menu-section(data-panel="other-buttons", ng-if="!isWatchMode")
          span.material-symbols-outlined remote_gen
          span.side-menu-section-title Спефицичные кнопки

        .side-menu-section(data-panel="screenshots", ng-if="!isWatchMode")
          span.material-symbols-outlined screenshot_monitor
          span.side-menu-section-title Скриншоты

        .side-menu-section(data-panel="device-info")
          span.material-symbols-outlined info
          span.side-menu-section-title Информация о девайсе

        .side-menu-section(data-panel="misc-panel", ng-if="!isWatchMode")
          span.material-symbols-outlined settings_applications
          span.side-menu-section-title Дополнительно

      // Боковая панель - Работа с приложением
      .side-panel-content.bg-glass#app-panel
        h4.mb-5 Работа с приложением
        h5.mb-3.d-flex.align-items-center Установка приложения
          span.material-symbols-outlined.ms-2.fs-5.text-muted(data-tippy-content="<p>Установить APK-файл нашего приложения с компьютера.<div>Можно установить только приложение Okko :)") help
        div(ng-include='"control-panes/dashboard/install/install.pug"')

        h5.mb-3.mt-5.d-flex.align-items-center Deeplinks
          span.material-symbols-outlined.ms-2.fs-5.text-muted(data-tippy-content="<p>Диплинки - это ссылки, которые должны открывать нужный контент в нашем приложении.<div>Обычно начинаются с <tt>okko://</tt>") help
        div(ng-include='"control-panes/dashboard/shell/shell.pug"')

      // Боковая панель - Логи и отладка
      .side-panel-content.bg-glass#app-logs
        h4.mb-5 Логи и отладка

        div(ng-if="!isWatchMode")
          h5.mb-3.d-flex.align-items-center ADB port reverse
            span.material-symbols-outlined.ms-2.fs-5.text-muted(data-tippy-content="<p>Подключиться к устройству, будто он напрямую подключен к твоему ноутбуку.<div>Как использовать – читать в FAQ в левом нижнем углу экрана") help
          div(ng-include='"control-panes/advanced/remote-debug/remote-debug.pug"')

        div.alert.alert-info.mt-5(ng-if="isWatchMode")
          div.d-flex
            span.material-symbols-outlined.me-2.fs-1.text-muted warning
            div.small.text-secondary Включать и отключать поток логов может только <b>текущий владелец устройства</b>.<br>Но тебе доступна отдельная фильтрация по критичности и подстроке :)


        h5.mb-3.d-flex.align-items-center Logcat приложения
          span.material-symbols-outlined.ms-2.fs-5.text-muted(data-tippy-content="<p>Логи устройства в реальном времени.<div>Не забудь использовать фильтр, например <tt>ru.more.play</tt>") help
        div(ng-include='"control-panes/logs/logs.pug"')

      // Боковая панель - Специфичные кнопки
      .side-panel-content.bg-glass#other-buttons
        h4.mb-5 Специфичные кнопки
        div(ng-include='"control-panes/advanced/input/input.pug"')

      // Боковая панель - Скриншоты
      .side-panel-content.bg-glass#screenshots
        h4.mb-5 Скриншоты
        div(ng-include='"control-panes/screenshots/screenshots.pug"')

      // Боковая панель - Информация о девайсе
      .side-panel-content.bg-glass#device-info
        h4.mb-5 Информация о девайсе
        div(ng-include='"control-panes/info/info.pug"')

      // Боковая панель - Дополнительно
      .side-panel-content.bg-glass#misc-panel
        h4.mb-5 Дополнительно
        h5.mb-3.d-flex.align-items-center Полезное

        button.btn.btn-outline-secondary(ng-click='control.identify()', style="margin: 1em 1em 0 0 !important;", data-tippy-content="На девайсе экран загорится ярко-красным цветом, а на него выведется служебная информация. Так найти устройство гораздо проще :)")
          span.material-symbols-outlined(style="font-size: 7px; scale: 2") search
          span.ms-3 Найти девайс в лабе

        h5.mt-5.mb-3.d-flex.align-items-center Поделиться стримом
          span.material-symbols-outlined.ms-2.fs-5.text-muted(data-tippy-content="<p>Отправь ссылку коллеге, чтобы синхронно отлаживать приложение!<div>Он также сможет смотреть логи в реальном времени – но не сможет управлять вашим девайсом") help
        a.d-none(ng-href="/#!/watch/{{device.serial}}")
        textarea.form-control(ng-model="watchUrl", style="border: none; min-height: inherit; width: 350px; padding: 0 !important; height: 20px;background-color: black !important", readonly)
        button.btn.btn-outline-secondary(ng-click='copyToClipboard()', style="margin: 1em 1em 0 0 !important;")
          span.material-symbols-outlined(style="font-size: 7px; scale: 2") content_copy
          span.ms-3 Скопировать ссылку

    // Нижнее меню
    .bottom-menu.bg-glass
      // Помощь слева
      .menu-center-left(data-tippy-content="Наша дока в Confluence")
        span.material-symbols-outlined help
        span.mattermost-text Помощь

      // Центральная группа иконок
      .menu-center-group
        if !isWatchMode
          .menu-item
            span.material-symbols-outlined(ng-click="deviceControls.tryToRotate('portrait')", data-tippy-content="Портретный режим") mobile_lock_portrait
          .menu-item
            span.material-symbols-outlined(ng-click="deviceControls.tryToRotate('landscape')", data-tippy-content="Ландшафтный режим") mobile_lock_landscape
          .menu-divider
          .menu-item
            span.material-symbols-outlined(device-control-key='back', data-tippy-content="Назад") chevron_left
          .menu-item
            span.material-symbols-outlined(device-control-key='home', data-tippy-content="На главную") home
          .menu-item
            span.material-symbols-outlined(device-control-key='app_switch', data-tippy-content="Меню") menu
          .menu-divider
        .menu-item
          span.material-symbols-outlined(ng-click='deviceControls.kickDevice(device, $event)', data-tippy-content="Отключиться") power_settings_new

      // ЧСВ-раздел с копирайтом
      .menu-center-right
        a.mattermost-link(href="mattermost://chat.okko.team/okko/messages/@a.shcherbakov" target="_blank")
          svg.mattermost-icon(viewBox="0 0 501 501" xmlns="http://www.w3.org/2000/svg")
            path(d="M236 .7C137.7 7.5 54 68.2 18.2 158.5c-32 81-19.6 172.8 33 242.5 39.8 53 97.2 87 164.3 97 16.5 2.7 48 3.2 63.5 1.2 48.7-6.3 92.2-24.6 129-54.2 13-10.5 33-31.2 42.2-43.7 26.4-35.5 42.8-75.8 49-120.3 1.6-12.3 1.6-48.7 0-61-4-28.3-12-54.8-24.2-79.5-12.8-26-26.5-45.3-46.8-65.8C417.8 64 400.2 49 398.4 49c-.6 0-.4 10.5.3 26l1.3 26 7 8.7c19 23.7 32.8 53.5 38.2 83 2.5 14 3 43 1 55.8-4.5 27.8-15.2 54-31 76.5-8.6 12.2-28 31.6-40.2 40.2-24 17-50 27.6-80 33-10 1.8-49 1.8-59 0-43-7.7-78.8-26-107.2-54.8-29.3-29.7-46.5-64-52.4-104.4-2-14-1.5-42 1-55C90 121.4 132 72 192 49.7c8-3 18.4-5.8 29.5-8.2 1.7-.4 34.4-38 35.3-40.6.3-1-10.2-1-20.8-.4z")
            path(d="M322.2 24.6c-1.3.8-8.4 9.3-16 18.7-7.4 9.5-22.4 28-33.2 41.2-51 62.2-66 81.6-70.6 91-6 12-8.4 21-9 33-1.2 19.8 5 36 19 50C222 268 230 273 243 277.2c9 3 10.4 3.2 24 3.2 13.8 0 15 0 22.6-3 23.2-9 39-28.4 45-55.7 2-8.2 2-28.7.4-79.7l-2-72c-1-36.8-1.4-41.8-3-44-2-3-4.8-3.6-7.8-1.4z")
          span.mattermost-text a.shcherbakov

    // Gradients
    #gradient2.gradient
    #gradient3.gradient